2023-06-29 15:41:43,526 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 15:41:44,323 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 15:41:58,870 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 15:42:00,746 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 15:42:02,067 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 15:42:03,327 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 15:42:04,322 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 15:42:04,973 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 15:42:05,593 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 15:42:05,844 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 15:42:05,847 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:16:05,147 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 16:16:05,794 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 16:16:10,149 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 16:16:11,166 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 16:16:11,365 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 16:16:11,549 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 16:16:12,493 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 16:16:12,637 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 16:16:13,925 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 16:16:13,929 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:16:24,964 INFO [ufo_scraper.py:80] UFO data extraction complete with 674 rows and 9 columns
2023-06-29 16:16:33,611 ERROR [table_manager.py:73] An error occurred while calling o460.save
2023-06-29 16:17:57,280 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 16:17:57,942 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 16:18:11,654 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 16:18:13,238 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 16:18:14,593 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 16:18:15,706 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 16:18:16,408 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 16:18:17,120 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 16:18:17,929 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 16:18:18,182 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 16:18:18,188 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:18:24,362 INFO [ufo_scraper.py:80] UFO data extraction complete with 674 rows and 9 columns
2023-06-29 16:18:27,065 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/bronze
2023-06-29 16:18:28,989 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/bronze
2023-06-29 16:18:28,999 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/bronze
2023-06-29 16:18:42,947 INFO [transformations.py:82] Silver layer transformation completed
2023-06-29 16:18:45,613 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/silver
2023-06-29 16:18:45,841 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/silver
2023-06-29 16:18:45,851 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/silver
2023-06-29 16:18:53,394 INFO [transformations.py:110] Gold layer transformation for dim_location completed
2023-06-29 16:18:54,287 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:18:54,482 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:18:54,489 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:19:01,781 INFO [transformations.py:139] Gold layer transformation for dim_description completed
2023-06-29 16:19:02,655 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:19:02,829 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:19:02,836 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:19:08,448 INFO [transformations.py:170] Gold layer transformation for dim_date completed
2023-06-29 16:19:09,361 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:19:09,533 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:19:09,539 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:19:14,897 INFO [transformations.py:196] Gold layer transformation for dim_astro completed
2023-06-29 16:19:15,628 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:19:15,798 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:19:15,803 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:19:23,535 ERROR [transformations.py:244] [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `city` cannot be resolved. Did you mean one of the following? [`state`, `year`, `shape`, `moonPhaseAngle`].;
'Aggregate [state#15361, shape#15363, year#15368, moonPhaseAngle#15373], [state#15361, shape#15363, year#15368, moonPhaseAngle#15373, cast(count(state#15361) as int) AS state_count#15398, cast(count('city) as int) AS city_count#15400, cast(count(shape#15363) as int) AS shape_count#15402, cast(count(year#15368) as int) AS year_count#15404, cast(count('month) as int) AS month_count#15406, cast(count('week) as int) AS week_count#15408, cast(count('day) as int) AS day_count#15410, cast(count('hour) as int) AS hour_count#15412, cast(count(moonPhaseAngle#15373) as int) AS phaseangle_count#15414]
+- Project [state#15361, shape#15363, year#15368, moonPhaseAngle#15373]
   +- Relation [city#15360,state#15361,country#15362,shape#15363,duration#15364,summary#15365,images#15366,date#15367,year#15368,month#15369,dayofweek#15370,week#15371,hour#15372,moonPhaseAngle#15373] parquet

2023-06-29 16:22:19,198 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 16:22:19,749 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 16:22:26,680 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 16:22:26,933 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 16:22:27,142 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 16:22:27,350 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 16:22:27,537 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 16:22:27,697 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 16:22:27,850 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 16:22:28,083 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 16:22:28,086 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:22:36,220 INFO [ufo_scraper.py:80] UFO data extraction complete with 674 rows and 9 columns
2023-06-29 16:22:51,836 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/bronze
2023-06-29 16:22:53,910 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/bronze
2023-06-29 16:22:53,918 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/bronze
2023-06-29 16:23:10,074 INFO [transformations.py:82] Silver layer transformation completed
2023-06-29 16:23:17,724 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/silver
2023-06-29 16:23:18,054 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/silver
2023-06-29 16:23:18,062 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/silver
2023-06-29 16:23:38,974 INFO [transformations.py:110] Gold layer transformation for dim_location completed
2023-06-29 16:23:40,108 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:23:40,274 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:23:40,280 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:23:46,381 INFO [transformations.py:139] Gold layer transformation for dim_description completed
2023-06-29 16:23:47,615 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:23:47,818 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:23:47,825 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:23:55,264 INFO [transformations.py:170] Gold layer transformation for dim_date completed
2023-06-29 16:23:56,981 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:23:57,135 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:23:57,141 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:24:01,759 INFO [transformations.py:196] Gold layer transformation for dim_astro completed
2023-06-29 16:24:02,719 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:24:02,866 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:24:02,871 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:24:07,515 ERROR [transformations.py:249] [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `city` cannot be resolved. Did you mean one of the following? [`state`, `year`, `shape`, `moonPhaseAngle`].;
'Aggregate [state#15092, 'city, shape#15094, year#15099, 'month, 'week, 'day, 'hour, moonPhaseAngle#15104], [state#15092, 'city, shape#15094, year#15099, 'month, 'week, 'day, 'hour, moonPhaseAngle#15104, cast(count(state#15092) as int) AS state_count#15129, cast(count('city) as int) AS city_count#15131, cast(count(shape#15094) as int) AS shape_count#15133, cast(count(year#15099) as int) AS year_count#15135, cast(count('month) as int) AS month_count#15137, cast(count('week) as int) AS week_count#15139, cast(count('day) as int) AS day_count#15141, cast(count('hour) as int) AS hour_count#15143, cast(count(moonPhaseAngle#15104) as int) AS phaseangle_count#15145]
+- Project [state#15092, shape#15094, year#15099, moonPhaseAngle#15104]
   +- Relation [city#15091,state#15092,country#15093,shape#15094,duration#15095,summary#15096,images#15097,date#15098,year#15099,month#15100,dayofweek#15101,week#15102,hour#15103,moonPhaseAngle#15104] parquet

2023-06-29 16:27:01,265 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 16:27:01,831 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 16:27:06,899 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 16:27:07,221 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 16:27:07,430 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 16:27:07,669 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 16:27:07,868 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 16:27:08,065 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 16:27:08,217 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 16:27:08,460 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 16:27:08,464 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:27:16,835 INFO [ufo_scraper.py:80] UFO data extraction complete with 674 rows and 9 columns
2023-06-29 16:27:39,007 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/bronze
2023-06-29 16:27:43,683 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/bronze
2023-06-29 16:27:43,843 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/bronze
2023-06-29 16:27:58,685 INFO [transformations.py:82] Silver layer transformation completed
2023-06-29 16:28:14,370 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/silver
2023-06-29 16:28:14,777 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/silver
2023-06-29 16:28:14,788 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/silver
2023-06-29 16:28:23,530 INFO [transformations.py:110] Gold layer transformation for dim_location completed
2023-06-29 16:28:25,623 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:28:25,817 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:28:25,824 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:28:33,702 INFO [transformations.py:139] Gold layer transformation for dim_description completed
2023-06-29 16:28:35,149 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:28:35,301 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:28:35,307 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:28:42,962 INFO [transformations.py:170] Gold layer transformation for dim_date completed
2023-06-29 16:28:43,947 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:28:44,096 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:28:44,101 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:28:54,075 INFO [transformations.py:196] Gold layer transformation for dim_astro completed
2023-06-29 16:28:55,022 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:28:55,192 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:28:55,198 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:29:00,044 ERROR [transformations.py:254] [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `day` cannot be resolved. Did you mean one of the following? [`date`, `city`, `year`, `hour`, `shape`].;
'Project [state#15387, city#15386, shape#15389, year#15394, month#15395, week#15397, 'day, hour#15398, moonPhaseAngle#15399]
+- Relation [city#15386,state#15387,country#15388,shape#15389,duration#15390,summary#15391,images#15392,date#15393,year#15394,month#15395,dayofweek#15396,week#15397,hour#15398,moonPhaseAngle#15399] parquet

2023-06-29 16:31:32,127 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 16:31:32,693 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 16:31:43,933 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 16:31:45,375 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 16:31:46,579 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 16:31:47,429 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 16:31:48,139 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 16:31:48,799 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 16:31:49,793 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 16:31:50,038 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 16:31:50,042 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:31:55,189 INFO [ufo_scraper.py:80] UFO data extraction complete with 674 rows and 9 columns
2023-06-29 16:31:58,524 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/bronze
2023-06-29 16:32:00,414 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/bronze
2023-06-29 16:32:00,421 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/bronze
2023-06-29 16:32:11,092 INFO [transformations.py:82] Silver layer transformation completed
2023-06-29 16:32:13,604 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/silver
2023-06-29 16:32:13,800 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/silver
2023-06-29 16:32:13,807 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/silver
2023-06-29 16:32:21,769 INFO [transformations.py:110] Gold layer transformation for dim_location completed
2023-06-29 16:32:22,564 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:32:22,735 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:32:22,741 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:32:33,597 INFO [transformations.py:139] Gold layer transformation for dim_description completed
2023-06-29 16:32:34,475 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:32:34,636 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:32:34,642 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:32:52,683 INFO [transformations.py:170] Gold layer transformation for dim_date completed
2023-06-29 16:32:53,412 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:32:53,566 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:32:53,572 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:33:00,447 INFO [transformations.py:196] Gold layer transformation for dim_astro completed
2023-06-29 16:33:03,559 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:33:03,719 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:33:03,724 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:33:08,627 ERROR [transformations.py:254] [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `city` cannot be resolved. Did you mean one of the following? [`state`, `year`, `shape`, `moonPhaseAngle`].;
'Aggregate [state#15361, 'city, shape#15363, year#15368, 'month, 'week, 'day, 'hour, moonPhaseAngle#15373], [state#15361, 'city, shape#15363, year#15368, 'month, 'week, 'day, 'hour, moonPhaseAngle#15373, cast(count(state#15361) as int) AS state_count#15398, cast(count('city) as int) AS city_count#15400, cast(count(shape#15363) as int) AS shape_count#15402, cast(count(year#15368) as int) AS year_count#15404, cast(count('month) as int) AS month_count#15406, cast(count('week) as int) AS week_count#15408, cast(count('day) as int) AS day_count#15410, cast(count('hour) as int) AS hour_count#15412, cast(count(moonPhaseAngle#15373) as int) AS phaseangle_count#15414]
+- Project [state#15361, shape#15363, year#15368, moonPhaseAngle#15373]
   +- Relation [city#15360,state#15361,country#15362,shape#15363,duration#15364,summary#15365,images#15366,date#15367,year#15368,month#15369,dayofweek#15370,week#15371,hour#15372,moonPhaseAngle#15373] parquet

2023-06-29 16:39:16,184 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 16:39:16,818 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 16:39:27,816 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 16:39:29,257 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 16:39:30,265 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 16:39:31,525 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 16:39:32,368 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 16:39:33,116 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 16:39:33,805 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 16:39:34,049 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 16:39:34,053 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 16:39:42,281 INFO [ufo_scraper.py:80] UFO data extraction complete with 674 rows and 9 columns
2023-06-29 16:39:45,839 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/bronze
2023-06-29 16:39:47,940 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/bronze
2023-06-29 16:39:47,947 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/bronze
2023-06-29 16:39:58,389 INFO [transformations.py:82] Silver layer transformation completed
2023-06-29 16:40:01,018 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/silver
2023-06-29 16:40:01,220 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/silver
2023-06-29 16:40:01,227 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/silver
2023-06-29 16:40:09,574 INFO [transformations.py:110] Gold layer transformation for dim_location completed
2023-06-29 16:40:10,364 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:40:10,537 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:40:10,543 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_location
2023-06-29 16:40:20,348 INFO [transformations.py:139] Gold layer transformation for dim_description completed
2023-06-29 16:40:21,246 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:40:21,428 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:40:21,434 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_description
2023-06-29 16:40:27,284 INFO [transformations.py:170] Gold layer transformation for dim_date completed
2023-06-29 16:40:28,231 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:40:28,390 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:40:28,396 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_date
2023-06-29 16:40:37,650 INFO [transformations.py:196] Gold layer transformation for dim_astro completed
2023-06-29 16:40:38,393 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:40:38,553 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:40:38,558 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_astro
2023-06-29 16:41:54,360 INFO [transformations.py:251] Gold layer transformation for fact completed
2023-06-29 16:41:58,633 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/fact
2023-06-29 16:41:58,928 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/fact
2023-06-29 16:41:58,935 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/fact
2023-06-29 17:45:44,866 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 17:45:45,439 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 17:45:50,689 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 17:45:50,932 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 17:45:51,135 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 17:45:51,372 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 17:45:51,612 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 17:45:51,800 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 17:45:52,004 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 17:45:52,276 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 17:45:52,279 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 18:04:59,934 ERROR [ufo_scraper.py:86] <urlopen error EOF occurred in violation of protocol (_ssl.c:1129)>
2023-06-29 18:19:31,378 INFO [app_utils.py:140] 8 .py files found ['./src/app_utils.py', './src/start_pipeline.py', './src/address_cleaning.py', './src/spark/table_schema.py', './src/spark/spark_utils.py', './src/spark/transformations.py', './src/spark/ufo_scraper.py', './src/spark/table_manager.py']
2023-06-29 18:19:31,955 INFO [spark_utils.py:33] Created SparkSession for app:ufo @ spark://spark-master:7077 using delta-spark:2.4.0
2023-06-29 18:19:36,105 INFO [table_manager.py:102] Delta table: bronze created  @ 'ufo/bronze'
2023-06-29 18:19:36,336 INFO [table_manager.py:102] Delta table: silver created  @ 'ufo/silver'
2023-06-29 18:19:36,528 INFO [table_manager.py:102] Delta table: dim_location created  @ 'ufo/gold/dim_location'
2023-06-29 18:19:36,711 INFO [table_manager.py:102] Delta table: dim_description created  @ 'ufo/gold/dim_description'
2023-06-29 18:19:36,896 INFO [table_manager.py:102] Delta table: dim_date created  @ 'ufo/gold/dim_date'
2023-06-29 18:19:37,060 INFO [table_manager.py:102] Delta table: dim_astro created  @ 'ufo/gold/dim_astro'
2023-06-29 18:19:37,215 INFO [table_manager.py:102] Delta table: fact created  @ 'ufo/gold/fact'
2023-06-29 18:19:37,686 INFO [app_utils.py:78] Received response from https://nuforc.org/webreports/ndxevent.html
2023-06-29 18:19:37,689 INFO [ufo_scraper.py:32] Retreived 978 links
2023-06-29 18:58:13,209 INFO [ufo_scraper.py:80] UFO data extraction complete with 144451 rows and 9 columns
2023-06-29 18:59:35,164 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/bronze
2023-06-29 18:59:56,094 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/bronze
2023-06-29 18:59:56,100 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/bronze
2023-06-29 19:00:12,069 INFO [transformations.py:82] Silver layer transformation completed
2023-06-29 19:00:20,764 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/silver
2023-06-29 19:00:22,621 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/silver
2023-06-29 19:00:22,627 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/silver
2023-06-29 19:00:29,841 INFO [transformations.py:110] Gold layer transformation for dim_location completed
2023-06-29 19:00:31,127 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_location
2023-06-29 19:00:31,320 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_location
2023-06-29 19:00:31,326 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_location
2023-06-29 19:00:36,910 INFO [transformations.py:139] Gold layer transformation for dim_description completed
2023-06-29 19:00:38,377 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_description
2023-06-29 19:00:39,391 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_description
2023-06-29 19:00:39,397 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_description
2023-06-29 19:00:44,767 INFO [transformations.py:170] Gold layer transformation for dim_date completed
2023-06-29 19:00:46,107 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_date
2023-06-29 19:00:46,281 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_date
2023-06-29 19:00:46,287 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_date
2023-06-29 19:00:51,192 INFO [transformations.py:196] Gold layer transformation for dim_astro completed
2023-06-29 19:00:52,180 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/dim_astro
2023-06-29 19:00:52,338 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/dim_astro
2023-06-29 19:00:52,343 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/dim_astro
2023-06-29 19:00:57,341 INFO [transformations.py:251] Gold layer transformation for fact completed
2023-06-29 19:00:59,184 INFO [table_manager.py:67] Data successfully loaded into delta lake @ ./deltalake/ufo/gold/fact
2023-06-29 19:01:00,342 INFO [table_manager.py:29] Coalescing files @ ./deltalake/ufo/gold/fact
2023-06-29 19:01:00,349 INFO [table_manager.py:48] Vacuuming data after optimization @ ./deltalake/ufo/gold/fact
